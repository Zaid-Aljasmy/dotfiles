#!/bin/bash

battery_path="/sys/class/power_supply/BAT0"
if [[ ! -d "$battery_path" ]]; then
    battery_path="/sys/class/power_supply/BAT1"
fi

if [[ ! -d "$battery_path" ]]; then
    echo "Battery not found"
    exit 1
fi


if [[ -f "$battery_path/status" ]] && [[ -f "$battery_path/capacity" ]]; then
    status=$(cat "$battery_path/status")
    capacity=$(cat "$battery_path/capacity")
else
    echo "Battery files not found"
    exit 1
fi

status_lower=$(echo "$status" | tr '[:upper:]' '[:lower:]')
label=""

if [[ "$status_lower" == "charging" ]]; then
    label=" chr"
elif [[ "$status_lower" == "full" || "$status_lower" == "not charging" ]]; then
    label=" full"
elif [[ "$capacity" -le 20 && "$status_lower" == "discharging" ]]; then
    label=" low"
fi

color="#a9b1d6"
echo "<span foreground='$color'>Bat</span> $capacity%$label"
